{
  "version": 3,
  "sources": ["../src/shared/messages.ts", "../src/popup/index.ts"],
  "sourcesContent": ["export const MessageType = {\n  OptimizePrompt: 'OPTIMIZE_PROMPT',\n  TriggerOptimize: 'TRIGGER_OPTIMIZE'\n} as const;\n\nexport type MessageKind = typeof MessageType[keyof typeof MessageType];\n\nexport type OptimizePromptRequest = {\n  type: typeof MessageType.OptimizePrompt;\n  payload: {\n    originalPrompt: string;\n    styleId?: string;\n    source?: 'content-script' | 'popup';\n    pageHost?: string;\n  };\n};\n\nexport type OptimizePromptResponse = {\n  success: boolean;\n  optimizedPrompt?: string;\n  error?: string;\n};\n\nexport type TriggerOptimizeMessage = {\n  type: typeof MessageType.TriggerOptimize;\n};\n\nexport function isOptimizePromptRequest(message: unknown): message is OptimizePromptRequest {\n  if (!message || typeof message !== 'object') return false;\n  const typed = message as OptimizePromptRequest;\n  return typed.type === MessageType.OptimizePrompt && Boolean(typed.payload?.originalPrompt);\n}\n\nexport function isTriggerOptimizeMessage(message: unknown): message is TriggerOptimizeMessage {\n  if (!message || typeof message !== 'object') return false;\n  const typed = message as TriggerOptimizeMessage;\n  return typed.type === MessageType.TriggerOptimize;\n}\n", "import { MessageType, OptimizePromptResponse } from '../shared/messages';\n\nconst inputEl = document.getElementById('inputPrompt') as HTMLTextAreaElement;\nconst outputEl = document.getElementById('outputPrompt') as HTMLTextAreaElement;\nconst statusEl = document.getElementById('statusText') as HTMLDivElement;\nconst optimizeBtn = document.getElementById('optimizeBtn') as HTMLButtonElement;\nconst copyBtn = document.getElementById('copyBtn') as HTMLButtonElement;\nconst clearBtn = document.getElementById('clearBtn') as HTMLButtonElement;\nconst styleSelect = document.getElementById('styleSelect') as HTMLSelectElement;\n\noptimizeBtn?.addEventListener('click', optimizePrompt);\ncopyBtn?.addEventListener('click', copyOutput);\nclearBtn?.addEventListener('click', clearFields);\n\nfunction setStatus(text: string) {\n  if (!statusEl) return;\n  statusEl.textContent = text;\n}\n\nasync function optimizePrompt() {\n  const prompt = inputEl?.value.trim() || '';\n  if (!prompt) {\n    setStatus('\u8BF7\u8F93\u5165\u9700\u8981\u4F18\u5316\u7684 Prompt');\n    return;\n  }\n  setLoading(true);\n  setStatus('\u4F18\u5316\u4E2D...');\n  try {\n    const response = (await chrome.runtime.sendMessage({\n      type: MessageType.OptimizePrompt,\n      payload: { originalPrompt: prompt, styleId: styleSelect?.value, source: 'popup' }\n    })) as OptimizePromptResponse;\n\n    if (!response?.success || !response.optimizedPrompt) {\n      setStatus(response?.error || '\u4F18\u5316\u5931\u8D25');\n      return;\n    }\n    if (outputEl) outputEl.value = response.optimizedPrompt;\n    setStatus('\u5B8C\u6210\uFF0C\u53EF\u590D\u5236\u6216\u7F16\u8F91');\n  } catch (error) {\n    console.error('Optimize failed', error);\n    setStatus('\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E');\n  } finally {\n    setLoading(false);\n  }\n}\n\nfunction copyOutput() {\n  const value = outputEl?.value || '';\n  if (!value) {\n    setStatus('\u6682\u65E0\u53EF\u590D\u5236\u5185\u5BB9');\n    return;\n  }\n  navigator.clipboard\n    .writeText(value)\n    .then(() => setStatus('\u5DF2\u590D\u5236'))\n    .catch(() => setStatus('\u590D\u5236\u5931\u8D25'));\n}\n\nfunction clearFields() {\n  if (inputEl) inputEl.value = '';\n  if (outputEl) outputEl.value = '';\n  setStatus('');\n}\n\nfunction setLoading(loading: boolean) {\n  optimizeBtn.disabled = loading;\n  copyBtn.disabled = loading;\n  clearBtn.disabled = loading;\n  optimizeBtn.textContent = loading ? '\u4F18\u5316\u4E2D\u2026' : '\u2728 \u4F18\u5316';\n}\n"],
  "mappings": ";AAAO,IAAM,cAAc;AAAA,EACzB,gBAAgB;AAAA,EAChB,iBAAiB;AACnB;;;ACDA,IAAM,UAAU,SAAS,eAAe,aAAa;AACrD,IAAM,WAAW,SAAS,eAAe,cAAc;AACvD,IAAM,WAAW,SAAS,eAAe,YAAY;AACrD,IAAM,cAAc,SAAS,eAAe,aAAa;AACzD,IAAM,UAAU,SAAS,eAAe,SAAS;AACjD,IAAM,WAAW,SAAS,eAAe,UAAU;AACnD,IAAM,cAAc,SAAS,eAAe,aAAa;AAEzD,aAAa,iBAAiB,SAAS,cAAc;AACrD,SAAS,iBAAiB,SAAS,UAAU;AAC7C,UAAU,iBAAiB,SAAS,WAAW;AAE/C,SAAS,UAAU,MAAc;AAC/B,MAAI,CAAC,SAAU;AACf,WAAS,cAAc;AACzB;AAEA,eAAe,iBAAiB;AAC9B,QAAM,SAAS,SAAS,MAAM,KAAK,KAAK;AACxC,MAAI,CAAC,QAAQ;AACX,cAAU,yDAAiB;AAC3B;AAAA,EACF;AACA,aAAW,IAAI;AACf,YAAU,uBAAQ;AAClB,MAAI;AACF,UAAM,WAAY,MAAM,OAAO,QAAQ,YAAY;AAAA,MACjD,MAAM,YAAY;AAAA,MAClB,SAAS,EAAE,gBAAgB,QAAQ,SAAS,aAAa,OAAO,QAAQ,QAAQ;AAAA,IAClF,CAAC;AAED,QAAI,CAAC,UAAU,WAAW,CAAC,SAAS,iBAAiB;AACnD,gBAAU,UAAU,SAAS,0BAAM;AACnC;AAAA,IACF;AACA,QAAI,SAAU,UAAS,QAAQ,SAAS;AACxC,cAAU,wDAAW;AAAA,EACvB,SAAS,OAAO;AACd,YAAQ,MAAM,mBAAmB,KAAK;AACtC,cAAU,8DAAY;AAAA,EACxB,UAAE;AACA,eAAW,KAAK;AAAA,EAClB;AACF;AAEA,SAAS,aAAa;AACpB,QAAM,QAAQ,UAAU,SAAS;AACjC,MAAI,CAAC,OAAO;AACV,cAAU,4CAAS;AACnB;AAAA,EACF;AACA,YAAU,UACP,UAAU,KAAK,EACf,KAAK,MAAM,UAAU,oBAAK,CAAC,EAC3B,MAAM,MAAM,UAAU,0BAAM,CAAC;AAClC;AAEA,SAAS,cAAc;AACrB,MAAI,QAAS,SAAQ,QAAQ;AAC7B,MAAI,SAAU,UAAS,QAAQ;AAC/B,YAAU,EAAE;AACd;AAEA,SAAS,WAAW,SAAkB;AACpC,cAAY,WAAW;AACvB,UAAQ,WAAW;AACnB,WAAS,WAAW;AACpB,cAAY,cAAc,UAAU,6BAAS;AAC/C;",
  "names": []
}
